<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decorator Dashboard - Emily Bakes Cakes</title>
    <link rel="stylesheet" href="css/dashboard-improved.css">
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <div class="header-left">
            <div class="header-logo">‚ú® EBC Dashboard</div>
            <div class="header-user">
                <div class="role-badge" id="staff-role">Staff</div>
                <div class="manager-name" id="staff-name">Loading...</div>
            </div>
        </div>
        <div class="header-right">
            <div class="header-stat">
                <span>‚ú®</span>
                <span id="header-decorating-count">0</span>
                <span class="header-stat-value">to decorate today</span>
            </div>
            <button class="header-btn" onclick="backToSite()">‚Üê Back to Site</button>
            <button class="logout-btn header-btn" onclick="handleLogout()">Logout</button>
        </div>
    </header>

    <!-- SIDEBAR NAVIGATION -->
    <nav class="nav-sidebar">
        <ul>
            <li><a href="decorator-dashboard.html" class="nav-link active">
                ‚ú® Dashboard
            </a></li>
            <li><a href="orders.html" class="nav-link">
                üìã My Orders
            </a></li>
            <li><a href="orders.html" class="nav-link">
                üé® Designs
            </a></li>
            <li><a href="orders.html" class="nav-link">
                üìù Notes
            </a></li>
        </ul>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="main-content">
        <div class="content">
            <!-- PAGE HEADER -->
            <div class="page-header">
                <h1 class="page-title">Decorator's Workspace</h1>
                <p class="page-subtitle">Design and decorate your daily creations</p>
            </div>

            <!-- DECORATION TASKS CARDS -->
            <div class="summary-grid">
                <div class="summary-card" onclick="location.href='orders.html'">
                    <div class="card-icon">‚ú®</div>
                    <div class="card-number" id="pending-decorate-count">0</div>
                    <div class="card-label">Cakes to Decorate</div>
                    <a href="orders.html" class="card-action">View Details ‚Üí</a>
                </div>
                <div class="summary-card" onclick="location.href='orders.html'">
                    <div class="card-icon">‚úÖ</div>
                    <div class="card-number" id="completed-decorate-count">0</div>
                    <div class="card-label">Completed Today</div>
                    <a href="orders.html" class="card-action">View Details ‚Üí</a>
                </div>
                <div class="summary-card" onclick="location.href='orders.html'">
                    <div class="card-icon">üé®</div>
                    <div class="card-number" id="custom-designs">0</div>
                    <div class="card-label">Custom Designs</div>
                    <a href="orders.html" class="card-action">View Gallery ‚Üí</a>
                </div>
            </div>

            <!-- QUICK ACTIONS -->
            <div class="section-header">
                <h2 class="section-title">Quick Actions</h2>
            </div>
            <div class="action-buttons">
                <button class="action-btn-primary" onclick="alert('Start Decoration - Feature Coming')">üé® Start Decorating</button>
                <button class="action-btn-primary" onclick="alert('Upload Design - Feature Coming')">üì∏ Upload Design</button>
                <a href="orders.html" class="action-btn-primary">üé® Design Gallery</a>
            </div>

            <!-- DECORATION STATUS -->
            <div class="section-header" style="margin-top: 40px;">
                <h2 class="section-title">Your Decoration Status</h2>
            </div>
            <div class="status-boxes">
                <div class="status-box baking">
                    <div class="status-number" id="status-pending-decorate">0</div>
                    <div class="status-label">In Progress</div>
                </div>
                <div class="status-box decorating">
                    <div class="status-number" id="status-ready-pickup">0</div>
                    <div class="status-label">Ready for Pickup</div>
                </div>
                <div class="status-box ready">
                    <div class="status-number" id="status-completed-decorate">0</div>
                    <div class="status-label">Completed</div>
                </div>
            </div>

            <!-- TODAY'S DECORATION QUEUE -->
            <div class="section-header" style="margin-top: 40px;">
                <h2 class="section-title">Today's Decoration Queue</h2>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>Cake Type</th>
                        <th>Design</th>
                        <th>Status</th>
                        <th>Pickup Date</th>
                        <th>Priority</th>
                    </tr>
                </thead>
                <tbody id="decoration-orders">
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px;">Loading...</td>
                    </tr>
                </tbody>
            </table>

            <!-- DESIGN PREFERENCES -->
            <div class="section-header" style="margin-top: 40px;">
                <h2 class="section-title">Design Preferences & Notes</h2>
            </div>
            <div id="design-notes" style="background: var(--surface); border: 1px solid var(--border-light); border-radius: 12px; padding: 24px; margin-bottom: 40px; min-height: 120px; color: var(--text-secondary);">
                Loading design preferences...
            </div>
        </div>
    </main>

    <script src="js/main.js"></script>
    <script>
        // Decorator-specific dashboard initialization
        document.addEventListener('DOMContentLoaded', () => {
            if (!checkAuthentication()) return;
            updateHeaderWithUserInfo();
            initializeNav();
            initializeDecoratorDashboard();
        });

        function initializeDecoratorDashboard() {
            // Get decorator's tasks
            const decoratingOrders = getTodaysOrders().filter(o => o.status === 'decorating' || o.status === 'pending');
            const completedToday = getTodaysOrders().filter(o => o.status === 'completed').length;
            
            const pendingDecorate = decoratingOrders.filter(o => o.status === 'decorating').length;
            const readyPickup = decoratingOrders.filter(o => o.status === 'pending').length;

            document.getElementById('pending-decorate-count').textContent = pendingDecorate;
            document.getElementById('completed-decorate-count').textContent = completedToday;
            document.getElementById('custom-designs').textContent = Math.floor(Math.random() * 20) + 5;
            document.getElementById('header-decorating-count').textContent = pendingDecorate;

            // Status counts
            document.getElementById('status-pending-decorate').textContent = pendingDecorate;
            document.getElementById('status-ready-pickup').textContent = readyPickup;
            document.getElementById('status-completed-decorate').textContent = completedToday;

            // Populate decoration orders table
            populateDecorationOrders();

            // Load design notes
            loadDesignNotes();
        }

        function populateDecorationOrders() {
            const orders = getTodaysOrders().slice(0, 8);
            const tbody = document.getElementById('decoration-orders');
            tbody.innerHTML = '';

            const designs = ['Classic', 'Floral', 'Modern', 'Elegant', 'Playful'];

            orders.forEach((order, idx) => {
                const row = document.createElement('tr');
                const priority = idx < 3 ? 'High' : 'Normal';
                row.innerHTML = `
                    <td>#${order.id.substring(0, 8)}</td>
                    <td>${order.cakeType}</td>
                    <td>${designs[idx % designs.length]}</td>
                    <td><span class="status-badge badge-${order.status}">${order.status}</span></td>
                    <td>${order.pickupDate}</td>
                    <td><strong style="color: ${priority === 'High' ? '#EF4444' : '#10B981'}">${priority}</strong></td>
                `;
                tbody.appendChild(row);
            });
        }

        function loadDesignNotes() {
            const notes = [
                'üé® Birthday Cake: Add colorful sprinkles and "Happy Birthday"',
                'üíê Wedding Cake: Elegant white frosting with floral accents',
                'üéÇ Custom Design: Follow customer color preferences - pastels theme'
            ];

            const container = document.getElementById('design-notes');
            container.innerHTML = notes.map(note => `<div style="padding: 8px 0; color: var(--text);">‚Ä¢ ${note}</div>`).join('');
        }
    </script>
</body>
</html>
